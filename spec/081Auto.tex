\section{Автомат}\label{PRG.Auto}

Автомат, который лежит в основе программируемых алгоритмов, 
характеризуется состоянием и управляется командами.
%
Основные команды состоят в загрузке и (или) выгрузке данных.
Дополнительные служебные команды управляют состоянием автомата~---
инициализируют его или необратимо меняют.

На вход автомата могут поступать анонсы, ключи, 
открытые данные или данные, которые требуется зашифровать или расшифровать. 
%
Выгружаться могут зашифрованные или расшифрованные данные, хэш-значения, 
имитовставки, псевдослучайные числа. Выходные данные могут использоваться в 
качестве входных для другого автомата.

В таблице~\ref{Table.PRG.InOut} описаны допустимые типы данных. 
Типам назначены $6$-битовые коды.

\begin{table}[thb]
\caption{Типы данных автомата}\label{Table.PRG.InOut}
\begin{tabular}{|c|l|c|}
\hline
Тип & Описание & Код\\
\hline
\hline
\texttt{NULL} & Служебные данные & 
$000000$\\
%
\texttt{KEY} & Ключ & 
$000001$\\
%
\texttt{DATA} & Открытые входные данные & 
$000010$\\
%
\texttt{TEXT} & Сообщения для зашифрования или расшифрования & 
$000011$\\
%
\texttt{OUT} & Выходные данные & 
$000100$\\
\hline
\end{tabular}
\end{table}

\addendum{Перечень допустимых команд автомата}:
\begin{itemize}
\item
\algname{start} (инициализировать);
\item
\algname{restart} (повторно инициализировать);
\item
\algname{absorb} (загрузить данные);
\item
\algname{squeeze} (выгрузить данные);
\item
\algname{encrypt} (зашифровать);
\item
\algname{decrypt} (расшифровать);
\item
\algname{ratchet} (необратимо изменить состояние).
\end{itemize}

Команды выполняются в отложенной манере: выполнение текущей 
команды завершается в начале выполнения следующей.
Для завершения используется внутренняя служебная команда~\algname{commit}, 
которую можно вызывать только из других команд.

Команды определяются в~\ref{PRG.Start}~--- \ref{PRG.Ratchet}.
%
Каждая команда имеет полный доступ к состоянию автомата.
Состояние исключается из входных и выходных данных команд.

