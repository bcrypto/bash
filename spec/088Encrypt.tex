\section{Команда \algname{encrypt}}\label{PRG.Encrypt}

\subsection{Интерфейс}\label{PRG.Encrypt.IFace}

Входными данными команды~$\algname{encrypt}$ является 
сообщение~$X\in\{0,1\}^{8*}$.

Выходными данными является зашифрованное сообщение~$Y\in\{0,1\}^{|X|}$.

Используется алгоритм~$\algname{bash-f}$, определенный в~\ref{F}.

\subsection{Алгоритм}\label{PRG.Encrypt.Alg}

Команда $\algname{encrypt}(X)$ выполняется следующим образом:
\begin{enumerate}
\item
Выполнить
$\algname{commit}(\texttt{TEXT})$.
\item
Определить $(X_1,X_2,\ldots,X_n)=\Split(X,r)$.
\item
Установить $Y\leftarrow\perp$. 
\item
Для $i=1,2,\ldots,n$:
\begin{enumerate}
\item
$pos\leftarrow |X_i|$;
\item
$S[\dots pos)\leftarrow S[\dots pos)\oplus X_i$;
\item
$Y\leftarrow Y\parallel S[\dots pos)$;
\item
если $pos=r$, то 
$S\leftarrow\algname{bash-f}(S)$ и $pos\leftarrow 0$.
\end{enumerate}
\item
Возвратить $Y$.
\end{enumerate}
